<html>
  <head>
    <title>Live Chat Example</title>
    <script src="https://cdn.jsdelivr.net/npm/gun/gun.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gun/sea.js"></script>
    <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.4.1.min.js"></script>
    <script src="../iris.js"></script>
    <link rel="stylesheet" type="text/css" href="style.css">
  </head>
  <body>
    <script type="text/javascript">
      iris.Key.getDefault().then(key => {
        var gun = new Gun(['https://gun-eu.herokuapp.com/gun']);
        var chat = new iris.Chat({gun, key, participants: key.pub, onMessage: (msg, info) => {
          var msgContent = $('<div>').addClass('iris-msg-content').text(msg.text);
          msgContent.append($('<div>').text(iris.util.formatTime(new Date(msg.time))).addClass('time'));
          msgContent.html(msgContent.html().replace(/\n/g, '<br>\n'));
          var msgEl = $('<div>').toggleClass('our', info.selfAuthored).addClass('iris-chat-message').append(msgContent);
          $('.iris-chat-messages').append(msgEl);
        }});
        $('body').prepend(chat.getChatBox());
        var i = 0;
      });
    </script>
  </body>
</html>
